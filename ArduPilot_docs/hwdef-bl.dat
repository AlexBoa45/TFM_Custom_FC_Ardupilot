# hwdef-bl.dat - CustomH7 

# --- 1. FISICA DEL MICRO (ESTO ES TUYO) ---
MCU STM32H7xx STM32H743xx

OSCILLATOR_HZ 24000000
STM32_HSE_BYPASS
STM32_LSE_BYPASS

# TU IDENTIFICACION USB
APJ_BOARD_ID 1001
USB_VENDOR 0x2DAE
USB_PRODUCT 0x1001
USB_STRING_MANUFACTURER "CustomH7"
USB_STRING_BOOTLOADER "CustomH7 Bootloader"

# --- 2. MAPA DE MEMORIA (ESTANDAR H7) ---
FLASH_SIZE_KB 2048
FLASH_RESERVE_START_KB 0
FLASH_BOOTLOADER_LOAD_KB 128
APP_START_OFFSET 0x20000

# --- 3. PINES (ESTO ES TUYO) ---
PA11 OTG_FS_DM OTG1
PA12 OTG_FS_DP OTG1
PA9  VBUS INPUT

PC6 USART6_TX USART6
PC7 USART6_RX USART6


# Chip Selects (Para mantener sensores callados al inicio)
PA4  ICM_CS       CS
PE11 BMI_ACCEL_CS CS
PE10 BMI_GYRO_CS  CS
PE8  EXT_CS1      CS
PB12 EXT_CS2      CS

# --- 4. LOGICA DE SOFTWARE ---
SERIAL_ORDER OTG1 USART6

# Configuracion del Sistema Operativo para leer SD
define CH_CFG_USE_MEMCORE 1
define CH_CFG_USE_HEAP 1
define CH_CFG_USE_SEMAPHORES 0
define CH_CFG_USE_MUTEXES 1
define CH_CFG_USE_DYNAMIC 1
define CH_CFG_USE_WAITEXIT 1
define CH_CFG_USE_REGISTRY 1

# PINES SD (Coinciden con Matek, son estandar en H7)
PC8  SDMMC1_D0  SDMMC1
PC9  SDMMC1_D1  SDMMC1
PC10 SDMMC1_D2  SDMMC1
PC11 SDMMC1_D3  SDMMC1
PC12 SDMMC1_CK  SDMMC1
PD2  SDMMC1_CMD SDMMC1
PA8  SD_DETECT  INPUT PULLUP

# Habilitar sistema de archivos FATFS
define HAL_OS_FATFS_IO 1

define AP_BOOTLOADER_FLASH_FROM_SD_ENABLED 1
